// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.24;

import {Test, console} from "forge-std/Test.sol";
import {YieldManager} from "../src/YieldManager.sol";

contract CrosschainDeposit is Test {

    YieldManager public yieldManager;
    address      public user = 0x31d2Af4c13737C89353710C4c2267E7217Bd6Aa8;
    address      public operator;

    function setUp() public {
        uint256 forkId = vm.createFork("https://sepolia.base.org");
        vm.selectFork(forkId);

        operator = vm.addr(1);

        vm.deal(operator, 100 ether);
        vm.deal(user, 100 ether);

        yieldManager = new YieldManager(
            0x8FE6B999Dc680CcFDD5Bf7EB0974218be2542DAA, // Token Messenger 
            0xE737e5cEBEEBa77EFE34D4aa090756590b1CE275, // Message Transmitter
            0x000000000000000000000000000000000000dEaD, // Mock Aave Pool
            0x036CbD53842c5426634e7929541eC2318f3dCF7e, // USDC address
            0x000000000000000000000000000000000000dEaD //  Aave USDC address
        );
    }

    function test_process_deposit() public {
        bytes memory attestion = hex"a8ba36d7ac3dfe6b641c42aa307b2fc9e25ff8738d42027682453afad3ff67d11a733d72f42b89ed0d84d643ed6964e3a07e9e702c12bb3e3a466ee6645dc7ac1ca2749d2fcf1bf1ed38d73cbbfcff84e65a968bab3df01cdb9ebd28e5b2a39c1c1aca26d5e3aeb4aca2278c2d9a3fb1f6c320609935501fc5d8f356e70ed26b151c";
        bytes memory message = hex"000000010000000200000006674b45915f48714b9d67ab68451fd090816ddcf57463cbf92fcefac153bb28b50000000000000000000000008fe6b999dc680ccfdd5bf7eb0974218be2542daa0000000000000000000000008fe6b999dc680ccfdd5bf7eb0974218be2542daa0000000000000000000000000000000000000000000000000000000000000000000003e8000003e8000000010000000000000000000000005fd84259d66cd46123540766be93dfe6d43130d70000000000000000000000005615deb798bb3e4dfa0139dfa1b3d433cc23b72f00000000000000000000000000000000000000000000000000000000000186a000000000000000000000000031d2af4c13737c89353710c4c2267e7217bd6aa8000000000000000000000000000000000000000000000000000000000001869f000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000001ab25a9000000000000000000000000000000000000000000000000000000000000000100000000000000000000000031d2af4c13737c89353710c4c2267e7217bd6aa800000000000000000000000000000000000000000000000000000000000186a0";

        yieldManager.processDeposit(
            message,
            attestion
        );

    }
}
